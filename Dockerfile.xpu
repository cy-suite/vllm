FROM intel/intel-extension-for-pytorch:2.1.30-xpu

# Sources to be removed by https://github.com/intel/ai-containers/pull/293
RUN apt-get update -y && \
    apt-get install -y --no-install-recommends --fix-missing \
    numactl \
    python3-dev \
    vim

WORKDIR /workspace/vllm
COPY ./ /workspace/vllm

RUN pip install --no-cache-dir -v -r requirements-xpu.txt

ENV VLLM_TARGET_DEVICE=xpu
RUN python setup.py install

CMD ["/bin/bash"]
