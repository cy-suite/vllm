INFO 05-17 08:20:32 pynccl.py:58] Loading nccl from library /root/.config/vllm/nccl/cu12/libnccl.so.2.18.1
INFO 05-17 08:20:33 llm_engine.py:81] Initializing an LLM engine (v0.4.0.post1) with config: model='lmsys/vicuna-7b-v1.5', speculative_config=None, tokenizer='lmsys/vicuna-7b-v1.5', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.float16, max_seq_len=4096, download_dir=None, load_format=auto, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=True, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, seed=0)
INFO 05-17 08:20:33 selector.py:77] Cannot use FlashAttention backend because the flash_attn package is not found. Please install it for better performance.
INFO 05-17 08:20:33 selector.py:33] Using XFormers backend.
INFO 05-17 08:20:35 weight_utils.py:194] Using model weights format ['*.bin']
INFO 05-17 08:20:45 model_runner.py:164] Loading model weights took 12.5523 GB
	execute_model: token id: tensor([0, 0, 0,  ..., 0, 0, 0], device='cuda:0'), positions: tensor([ 0,  1,  2,  ..., 13, 14, 15], device='cuda:0')
INFO 05-17 08:20:46 gpu_executor.py:81] # GPU blocks: 3394, # CPU blocks: 512
max model len 4096
	execute_model: token id: tensor([    1,  2266,   338,  ...,   363,   592, 29973], device='cuda:0'), positions: tensor([   0,    1,    2,  ..., 4060, 4061, 4062], device='cuda:0')
		FREE BLOCKS 3140
INFO 05-17 08:20:48 metrics.py:224] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 0.0 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 7.5%, CPU KV cache usage: 0.0%
	execute_model: token id: tensor([13], device='cuda:0'), positions: tensor([4063], device='cuda:0')
		FREE BLOCKS 3140
	execute_model: token id: tensor([13], device='cuda:0'), positions: tensor([4064], device='cuda:0')
		FREE BLOCKS 3139
	execute_model: token id: tensor([4013], device='cuda:0'), positions: tensor([4065], device='cuda:0')
		FREE BLOCKS 3139
	execute_model: token id: tensor([5650], device='cuda:0'), positions: tensor([4066], device='cuda:0')
		FREE BLOCKS 3139
	execute_model: token id: tensor([16612], device='cuda:0'), positions: tensor([4067], device='cuda:0')
		FREE BLOCKS 3139
	execute_model: token id: tensor([278], device='cuda:0'), positions: tensor([4068], device='cuda:0')
		FREE BLOCKS 3139
	execute_model: token id: tensor([349], device='cuda:0'), positions: tensor([4069], device='cuda:0')
		FREE BLOCKS 3139
	execute_model: token id: tensor([1165], device='cuda:0'), positions: tensor([4070], device='cuda:0')
		FREE BLOCKS 3139
	execute_model: token id: tensor([359], device='cuda:0'), positions: tensor([4071], device='cuda:0')
		FREE BLOCKS 3139
	execute_model: token id: tensor([5687], device='cuda:0'), positions: tensor([4072], device='cuda:0')
		FREE BLOCKS 3139
	execute_model: token id: tensor([363], device='cuda:0'), positions: tensor([4073], device='cuda:0')
		FREE BLOCKS 3139
	execute_model: token id: tensor([3657], device='cuda:0'), positions: tensor([4074], device='cuda:0')
		FREE BLOCKS 3139
	execute_model: token id: tensor([15387], device='cuda:0'), positions: tensor([4075], device='cuda:0')
		FREE BLOCKS 3139
	execute_model: token id: tensor([1136], device='cuda:0'), positions: tensor([4076], device='cuda:0')
		FREE BLOCKS 3139
	execute_model: token id: tensor([8841], device='cuda:0'), positions: tensor([4077], device='cuda:0')
		FREE BLOCKS 3139
	execute_model: token id: tensor([297], device='cuda:0'), positions: tensor([4078], device='cuda:0')
		FREE BLOCKS 3139
	execute_model: token id: tensor([263], device='cuda:0'), positions: tensor([4079], device='cuda:0')
		FREE BLOCKS 3139
	execute_model: token id: tensor([13235], device='cuda:0'), positions: tensor([4080], device='cuda:0')
		FREE BLOCKS 3138
	execute_model: token id: tensor([1788], device='cuda:0'), positions: tensor([4081], device='cuda:0')
		FREE BLOCKS 3138
	execute_model: token id: tensor([29889], device='cuda:0'), positions: tensor([4082], device='cuda:0')
		FREE BLOCKS 3138
	execute_model: token id: tensor([450], device='cuda:0'), positions: tensor([4083], device='cuda:0')
		FREE BLOCKS 3138
INFO 05-17 08:20:53 metrics.py:224] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 4.0 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 7.5%, CPU KV cache usage: 0.0%
	execute_model: token id: tensor([5687], device='cuda:0'), positions: tensor([4084], device='cuda:0')
		FREE BLOCKS 3138
	execute_model: token id: tensor([338], device='cuda:0'), positions: tensor([4085], device='cuda:0')
		FREE BLOCKS 3138
	execute_model: token id: tensor([2729], device='cuda:0'), positions: tensor([4086], device='cuda:0')
		FREE BLOCKS 3138
	execute_model: token id: tensor([373], device='cuda:0'), positions: tensor([4087], device='cuda:0')
		FREE BLOCKS 3138
	execute_model: token id: tensor([263], device='cuda:0'), positions: tensor([4088], device='cuda:0')
		FREE BLOCKS 3138
	execute_model: token id: tensor([24963], device='cuda:0'), positions: tensor([4089], device='cuda:0')
		FREE BLOCKS 3138
	execute_model: token id: tensor([5687], device='cuda:0'), positions: tensor([4090], device='cuda:0')
		FREE BLOCKS 3138
	execute_model: token id: tensor([393], device='cuda:0'), positions: tensor([4091], device='cuda:0')
		FREE BLOCKS 3138
	execute_model: token id: tensor([6511], device='cuda:0'), positions: tensor([4092], device='cuda:0')
		FREE BLOCKS 3138
	execute_model: token id: tensor([263], device='cuda:0'), positions: tensor([4093], device='cuda:0')
		FREE BLOCKS 3138
	execute_model: token id: tensor([2323], device='cuda:0'), positions: tensor([4094], device='cuda:0')
		FREE BLOCKS 3138
	execute_model: token id: tensor([10823], device='cuda:0'), positions: tensor([4095], device='cuda:0')
		FREE BLOCKS 3138
	execute_model: token id: tensor([304], device='cuda:0'), positions: tensor([4096], device='cuda:0')
		FREE BLOCKS 3137
	execute_model: token id: tensor([6755], device='cuda:0'), positions: tensor([4097], device='cuda:0')
		FREE BLOCKS 3137
	execute_model: token id: tensor([263], device='cuda:0'), positions: tensor([4098], device='cuda:0')
		FREE BLOCKS 3137
	execute_model: token id: tensor([995], device='cuda:0'), positions: tensor([4099], device='cuda:0')
		FREE BLOCKS 3137
	execute_model: token id: tensor([4249], device='cuda:0'), positions: tensor([4100], device='cuda:0')
		FREE BLOCKS 3137
	execute_model: token id: tensor([7972], device='cuda:0'), positions: tensor([4101], device='cuda:0')
		FREE BLOCKS 3137
	execute_model: token id: tensor([1819], device='cuda:0'), positions: tensor([4102], device='cuda:0')
		FREE BLOCKS 3137
	execute_model: token id: tensor([29889], device='cuda:0'), positions: tensor([4103], device='cuda:0')
		FREE BLOCKS 3137
	execute_model: token id: tensor([450], device='cuda:0'), positions: tensor([4104], device='cuda:0')
		FREE BLOCKS 3137
INFO 05-17 08:20:58 metrics.py:224] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 4.0 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 7.6%, CPU KV cache usage: 0.0%
	execute_model: token id: tensor([5687], device='cuda:0'), positions: tensor([4105], device='cuda:0')
		FREE BLOCKS 3137
	execute_model: token id: tensor([3913], device='cuda:0'), positions: tensor([4106], device='cuda:0')
		FREE BLOCKS 3137
	execute_model: token id: tensor([13638], device='cuda:0'), positions: tensor([4107], device='cuda:0')
		FREE BLOCKS 3137
	execute_model: token id: tensor([28931], device='cuda:0'), positions: tensor([4108], device='cuda:0')
		FREE BLOCKS 3137
	execute_model: token id: tensor([304], device='cuda:0'), positions: tensor([4109], device='cuda:0')
		FREE BLOCKS 3137
	execute_model: token id: tensor([9801], device='cuda:0'), positions: tensor([4110], device='cuda:0')
		FREE BLOCKS 3137
	execute_model: token id: tensor([393], device='cuda:0'), positions: tensor([4111], device='cuda:0')
		FREE BLOCKS 3137
	execute_model: token id: tensor([871], device='cuda:0'), positions: tensor([4112], device='cuda:0')
		FREE BLOCKS 3136
	execute_model: token id: tensor([263], device='cuda:0'), positions: tensor([4113], device='cuda:0')
		FREE BLOCKS 3136
	execute_model: token id: tensor([2323], device='cuda:0'), positions: tensor([4114], device='cuda:0')
		FREE BLOCKS 3136
	execute_model: token id: tensor([995], device='cuda:0'), positions: tensor([4115], device='cuda:0')
		FREE BLOCKS 3136
	execute_model: token id: tensor([338], device='cuda:0'), positions: tensor([4116], device='cuda:0')
		FREE BLOCKS 3136
	execute_model: token id: tensor([10434], device='cuda:0'), positions: tensor([4117], device='cuda:0')
		FREE BLOCKS 3136
	execute_model: token id: tensor([322], device='cuda:0'), positions: tensor([4118], device='cuda:0')
		FREE BLOCKS 3136
	execute_model: token id: tensor([393], device='cuda:0'), positions: tensor([4119], device='cuda:0')
		FREE BLOCKS 3136
	execute_model: token id: tensor([263], device='cuda:0'), positions: tensor([4120], device='cuda:0')
		FREE BLOCKS 3136
	execute_model: token id: tensor([995], device='cuda:0'), positions: tensor([4121], device='cuda:0')
		FREE BLOCKS 3136
	execute_model: token id: tensor([338], device='cuda:0'), positions: tensor([4122], device='cuda:0')
		FREE BLOCKS 3136
	execute_model: token id: tensor([10434], device='cuda:0'), positions: tensor([4123], device='cuda:0')
		FREE BLOCKS 3136
	execute_model: token id: tensor([1584], device='cuda:0'), positions: tensor([4124], device='cuda:0')
		FREE BLOCKS 3136
INFO 05-17 08:21:03 metrics.py:224] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 4.0 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 7.6%, CPU KV cache usage: 0.0%
	execute_model: token id: tensor([565], device='cuda:0'), positions: tensor([4125], device='cuda:0')
		FREE BLOCKS 3136
	execute_model: token id: tensor([263], device='cuda:0'), positions: tensor([4126], device='cuda:0')
		FREE BLOCKS 3136
	execute_model: token id: tensor([13638], device='cuda:0'), positions: tensor([4127], device='cuda:0')
		FREE BLOCKS 3136
	execute_model: token id: tensor([310], device='cuda:0'), positions: tensor([4128], device='cuda:0')
		FREE BLOCKS 3135
	execute_model: token id: tensor([19518], device='cuda:0'), positions: tensor([4129], device='cuda:0')
		FREE BLOCKS 3135
	execute_model: token id: tensor([526], device='cuda:0'), positions: tensor([4130], device='cuda:0')
		FREE BLOCKS 3135
	execute_model: token id: tensor([17581], device='cuda:0'), positions: tensor([4131], device='cuda:0')
		FREE BLOCKS 3135
	execute_model: token id: tensor([29889], device='cuda:0'), positions: tensor([4132], device='cuda:0')
		FREE BLOCKS 3135
	execute_model: token id: tensor([450], device='cuda:0'), positions: tensor([4133], device='cuda:0')
		FREE BLOCKS 3135
	execute_model: token id: tensor([5687], device='cuda:0'), positions: tensor([4134], device='cuda:0')
		FREE BLOCKS 3135
	execute_model: token id: tensor([3913], device='cuda:0'), positions: tensor([4135], device='cuda:0')
		FREE BLOCKS 3135
	execute_model: token id: tensor([19012], device='cuda:0'), positions: tensor([4136], device='cuda:0')
		FREE BLOCKS 3135
	execute_model: token id: tensor([7274], device='cuda:0'), positions: tensor([4137], device='cuda:0')
		FREE BLOCKS 3135
	execute_model: token id: tensor([322], device='cuda:0'), positions: tensor([4138], device='cuda:0')
		FREE BLOCKS 3135
	execute_model: token id: tensor([3544], device='cuda:0'), positions: tensor([4139], device='cuda:0')
		FREE BLOCKS 3135
	execute_model: token id: tensor([7274], device='cuda:0'), positions: tensor([4140], device='cuda:0')
		FREE BLOCKS 3135
	execute_model: token id: tensor([304], device='cuda:0'), positions: tensor([4141], device='cuda:0')
		FREE BLOCKS 3135
	execute_model: token id: tensor([9025], device='cuda:0'), positions: tensor([4142], device='cuda:0')
		FREE BLOCKS 3135
	execute_model: token id: tensor([19518], device='cuda:0'), positions: tensor([4143], device='cuda:0')
		FREE BLOCKS 3135
	execute_model: token id: tensor([304], device='cuda:0'), positions: tensor([4144], device='cuda:0')
		FREE BLOCKS 3134
INFO 05-17 08:21:08 metrics.py:224] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 4.0 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 7.7%, CPU KV cache usage: 0.0%
	execute_model: token id: tensor([23120], device='cuda:0'), positions: tensor([4145], device='cuda:0')
		FREE BLOCKS 3134

OUTPUT: (84 tokens)


This paper describes the Paxos algorithm for achieving consensus in a distributed system. The algorithm is based on a proposal algorithm that allows a single agent to choose a value among proposed values. The algorithm uses majority voting to ensure that only a single value is chosen and that a value is chosen even if a majority of agents are failing. The algorithm uses prepare requests and accept requests to enable agents to communicate 

[CompletionOutput(index=0, text='\n\nThis paper describes the Paxos algorithm for achieving consensus in a distributed system. The algorithm is based on a proposal algorithm that allows a single agent to choose a value among proposed values. The algorithm uses majority voting to ensure that only a single value is chosen and that a value is chosen even if a majority of agents are failing. The algorithm uses prepare requests and accept requests to enable agents to communicate', token_ids=[13, 13, 4013, 5650, 16612, 278, 349, 1165, 359, 5687, 363, 3657, 15387, 1136, 8841, 297, 263, 13235, 1788, 29889, 450, 5687, 338, 2729, 373, 263, 24963, 5687, 393, 6511, 263, 2323, 10823, 304, 6755, 263, 995, 4249, 7972, 1819, 29889, 450, 5687, 3913, 13638, 28931, 304, 9801, 393, 871, 263, 2323, 995, 338, 10434, 322, 393, 263, 995, 338, 10434, 1584, 565, 263, 13638, 310, 19518, 526, 17581, 29889, 450, 5687, 3913, 19012, 7274, 322, 3544, 7274, 304, 9025, 19518, 304, 23120, 2], cumulative_logprob=-35.53101127158777, logprobs=None, finish_reason=stop, stop_reason=None)]
